<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<link rel="shortcut icon" href="${basePath}/assets/images/favicon.ico">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<link rel="stylesheet" type="text/css" href="${basePath}/assets/css/simple-base.css?v=17.03.08.1"/>
		<link rel="stylesheet" type="text/css" href="${basePath}/assets/css/simple-order.css?v=17.03.08.1"/>
		<link rel="stylesheet" type="text/css" href="${basePath}/assets/css/simple-myorder.css?v=17.03.08.1"/>
		<title>${shopper.nick}-已下订单</title>
		
	</head>
	<body>
		<#if isEmpty==1>
		<#else>
			<#if isFirst==1 && myOrder.orderStatus?? && (myOrder.orderStatus==-1) && (myOrder.payStatus==0)>
				<div class="modeTips z16">
					本餐厅需要先支付，然后下厨
				</div>
				<#else>
			</#if>
		</#if>
		<div class="container" style="padding: 0;">
			<#if isEmpty==1>
				<!--标题begin -->
				<div class="cartInfoWrap" >
					<div class="cITitle" style="border:0">
						<span>已下订单</span>
					</div>
				</div>
				<!--标题end -->
				<!--已下订单为空 begin -->
				<div class="hisOrderList">
					<div class="noOrder">
						<img src="../assets/images/simple/noOrder.png"/>
						<div class="noOrderTips">
							暂无已下订单哦~
						</div>
						<div class="addDishTips">
							请点击下方<span>"加菜"</span>按钮开始点菜吧!
						</div>
					</div>
				</div>
				<!--已下订单为空 end-->
			<#else>
				<!--已下订单 信息begin -->
				<div class="cartInfoWrap" style="padding-bottom: 0;">
					<div class="fixBtnWrap z66">
						<#if myOrder.isOut?? && (myOrder.isOut==1)>
                        	<span class="underOrder">已下订单（打包）</span>
                        <#else>
                        	<span class="underOrder">已下订单</span>
                        </#if>
                        <#if (myOrder.orderStatus?? && (myOrder.orderStatus==-1) && (myOrder.payStatus==0))
                         || (myOrder.orderStatus?? && orderMode?? && (orderMode==0) && (myOrder.payStatus==0) && ((myOrder.orderStatus==0) || ((myOrder.orderStatus==1) && !(myOrder.tableNum?? && myOrder.tableNum!='')) || (myOrder.orderStatus==-1)))>
                        	&nbsp;•&nbsp;<span id="cancelOrder" class="cancelOrder contentBox">取消订单</span>
                        </#if>
						<!--刷新按钮begin -->
						<div id="refreshOrder" class="searchBtn z66">
							<a target="_self"><span></span></a>
							<div class="dot"></div>
						</div>
						<!--刷新按钮end -->
						<#if orderMode?? && orderMode==0>
				     	<#else>
						<!--呼叫服务begin -->
						<div class="callService z66">
							<span></span>
						</div>
						</#if>
						<!--呼叫服务end -->
					</div>
					<!--消费信息 begin -->
				<!--<div class="costInfo">-->
					<!--点的商品begin-->
					<!--<div class="divWrap myOrder">
							<span>您点了：</span>
							<span>
								<#list itemsCounts as itemsCount>
                            		${itemsCount.categoryName}<#if itemsCount.isWeight?? && itemsCount.isWeight==1><#else>+${itemsCount.count}</#if><#if itemsCount_has_next>,</#if>
                            	</#list>
                            </span>
					</div>-->
					<!--点的商品end-->
					<!--总计 begin -->
					<!--<div class="divWrap myOrder">
							合计<span>${itemsCounts?size}</span>项
					</div>-->
					<!--总计 end -->
					<!--<div class="wrap">
						<div class="costNum">
							<span class="lable">其他费用</span>
							<span class="right">${(myOrder.otherPrice?if_exists)?string('0.00')}</span>
						</div>
						<div class="consume">
							<span class="lable">订单￥${(myOrder.originalPrice?if_exists)?string('0.00')}</span>
							<span class="right">实付<span class="pay" id="totalPrices1">￥${(myOrder.totalPrices?if_exists)?string('0.00')}</span></span>
						</div>
					</div>
				</div>-->
				<!--消费信息 end -->
				<!--订单信息begin -->
				<div class="costInfo2" style="border-top: 0.08rem solid #eee;">
					<!--<div style="font-weight: bold;height: 2.0rem;line-height: 2.0rem;">
					订单信息
					</div>-->
					<div class="divWrap">
						<!--<div class="cel tabNo">-->
							<!--<span class="label">${tableName}：</span>
							<#if myOrder.tableNum?? && myOrder.tableNum!=''>
								<span class="no">${myOrder.tableNum}</span>
							<#else>
								<span class="no">预点餐</span>
							</#if>-->
							购物车共<span>${itemsCounts?size}</span>项
						<!--</div>-->
						<div class="cel person">
							<span class="label">人数：</span>
							<span>${myOrder.peopleNumber}</span>
						</div>
					</div>
					<!--备注信息 begin -->
					<!--<div class="orderTime">
							<span  class="label">下单时间：</span>
							<span>${myOrder.createTime?string("MM-dd HH:mm")}</span>
					</div>-->
					<!--备注信息 begin -->
					<div class="divWrap">
						<span class="lable">订单￥${(myOrder.originalPrice?if_exists)?string('0.00')}</span>
						<span class="right">金额<span class="pay" id="totalPrices1">￥<i>${(myOrder.totalPrices?if_exists)?string('0.00')}</i></span></span>
					</div>
					<div class="divWrap">
							<span class="">备注：</span>
							<#if myOrder.note?? && myOrder.note!=''>
								<span class="remarkTxt">${myOrder.note}</span>
							</#if>
							<div class="orderTime right">
								<span  class="label">下单时间：</span>
								<span>${myOrder.createTime?string("MM-dd HH:mm")}</span>
							</div>
					</div>
					
					<!--备注信息end -->
					<!--支付信息 begin -->
					<div class="payStatus">
						<div class="pSTitle">
							<#if myOrder.payStatus?? && (myOrder.payStatus==1)>
                      			<span>本单已支付</span>
                      			<#else>
                      			<span>本单尚未支付</span>
                      		</#if>
							<div class="payInfoDiv">
								<span class="downPayInfo">查看付款详情</span>
								<span class="downIcon iconImg"></span>
							</div>
						</div>
						  
						<div class="payInfo" style="padding-bottom: 0;">
							<div class="wrap hide">
								<div class="costNum">
									<span class="lable">消费金额</span>
									<span class="right">${(myOrder.originalPrice?if_exists)?string('0.00')}</span>
								</div>
								<div class="consume">
									<span class="lable">应付金额</span>
									<span class="right pay">${(myOrder.totalPrices?if_exists)?string('0.00')}</span>
								</div>
								<div class="paid">
									<span class="lable">已付金额</span>
									<span class="right pay">${(myOrder.totalPay?if_exists)?string('0.00')}</span>
								</div>
							</div>
						</div>
					</div>
					<!--支付信息 end -->
					<!--<div class="picDiv">
						<img src="../assets/images/simple/orderd.jpg"/>
					</div>-->
					<!--<div class="cITitle">
						<#if myOrder.isOut?? && (myOrder.isOut==1)>
                        	<span class="underOrder">已下订单（打包）</span>
                        <#else>
                        	<span class="underOrder">已下订单</span>
                        </#if>
                        <#if (myOrder.orderStatus?? && (myOrder.orderStatus==-1) && (myOrder.payStatus==0))
                         || (myOrder.orderStatus?? && orderMode?? && (orderMode==0) && (myOrder.payStatus==0) && ((myOrder.orderStatus==0) || ((myOrder.orderStatus==1) && !(myOrder.tableNum?? && myOrder.tableNum!='')) || (myOrder.orderStatus==-1)))>
                        	&nbsp;•&nbsp;<span id="cancelOrder" class="cancelOrder contentBox">取消订单</span>
                        </#if>
					</div>-->
				</div>
				</div>
				<!--已下订单 信息end -->
				<!--商品列表内容 begin-->
				<div class="cartInfoWrap" style="margin-bottom: 3rem;">
				<div class="productList" style="padding: 0;">
					
					<!--菜单列表 begin -->
					<div class="dishesList">
						<#if myOrder.payStatus?? && (myOrder.payStatus==1)>
                             <#else>
                             <div class="tipMess">
								请点屏幕右下角“去结账”按钮进行支付
							</div>
                        </#if>   
						<#list myOrder.items as item>
							<!--具体商品信息begin -->
							<div class="li-con">
								<div class="li-name" style="float: left;">
									<div class="name">${item.goodsName}</div>
									
									<#if item.isWeight?? && item.isWeight==1>
									<#else>
										<#if item.isNotshowSize?? && item.isNotshowSize==1>
											<#else>
											<#if item.type??>
												(${item.type})
											</#if>
										</#if>
									</#if>
									
								</div>
								<#if item.isWeight?? && item.isWeight==1 && item.buyConut==0>
									<div class="li-attr bearing">
								<#else>
									<div class="li-attr">
								</#if>
									
										<div class="li-price" style="color:#2d2d2d; float:right;">${(item.buyPrice?if_exists)?string('0.00')}<#if item.isWeight?? && item.isWeight==1><span>/${item.type}</span><#else></#if></div>
									<#if item.buyConut==0>
										<span class="count" buyCount="${item.buyConut}" isRefund="${item.isRefund?if_exists}">等待称重</span>
									<#else>
										<span class="count" buyCount="${item.buyConut}" isRefund="${item.isRefund?if_exists}"><#if item.isWeight?? && item.isWeight==1><#else></#if>${item.buyConut}</span>
                                  	</#if>
								</div>
								<#if item.goodsDesc?? && item.goodsDesc =='打包'>
									<div class="packed contentBox">打包</div>
								</#if>
								<!--备注信息 begin -->
								<#if item.goodsDesc?? && item.goodsDesc =='打包'>
								<div class="remarkInfo">
								<#else>
								<div class="remarkInfo" style="text-indent: 0;">
								</#if>
									<#if item.propdesc?? && item.propdesc!="">
                                    	(${item.propdesc})
                                    </#if>
								</div>
								<!--备注信息 end -->
								<!-- 订单状态 begin -->
								<#if item.isRefund?? && item.isRefund==1>
	                            	<p class="payState reDishes"></p>
	                            <#else>
	                                <#if myOrder.payStatus?? && myOrder.payStatus==1>
	                                	<div class="payState paid"></div>
	                                <#else>
	                                    <#if myOrder.orderStatus?? && myOrder.orderStatus==0>  
	                                    	<div class="payState pending"></div>
				                        <#elseif myOrder.orderStatus?? && myOrder.orderStatus==1 && !(myOrder.tableNum?? && myOrder.tableNum!='')>
				                            <div class="payState recived"></div>
				                        <#elseif myOrder.orderStatus?? && myOrder.orderStatus==2>
				                            <div class="payState refused"></div>
				                        <#elseif myOrder.orderStatus?? && myOrder.orderStatus==1 && (myOrder.tableNum?? && myOrder.tableNum!='')>
				                            <div class="payState underKitchen"></div>
				                        <#elseif myOrder.orderStatus?? && myOrder.orderStatus==-1>
				                            <div class="payState noPay"></div>
			                            <#elseif myOrder.orderStatus?? && myOrder.orderStatus==12>
				                            <div class="cancelState"></div>
				                        <#elseif myOrder.orderStatus?? && myOrder.orderStatus==3>
				                            <#if item.isAdd?? && item.isAdd==1>
				                            	<#if item.itemId??>
				                            		<div class="payState underKitchen"></div>
			                            		<#else>
				                            		<div class="payState pending"></div>
				                            	</#if>
					                        <#else>
					                            <div class="payState underKitchen"></div>
				                            </#if>
				                        <#else>
				                            <!--  <p class="sh"></p> -->                                                                                                                                                                                                                                                                 
					                    </#if>
	                                </#if>
	                            </#if>
								<!-- 订单状态 end -->
							</div>
							<!--具体商品信息end -->
						</#list>
					</div>
				</div>
				<!--商品列表内容 end-->
				
				</div>
				<!--订单信息end -->
				<!--弹窗window begin -->
				<div class="clearCartDiv z666 middle">
					<div class="dShow">
						<div class="clearCartTitle">
							店家已拒单，无法结账哦！		
						</div>
						<div class="clearCartBtn commonBtn">
							<input type="hidden" id="hintType">
							<div class="pCancel" id="cancel">
								取消
							</div>
							<div class="pConfirm" id="confirm">
								确定
							</div>
						</div>
					</div>
				</div>
				<!--弹窗window end -->
			</#if>
		</div>
		
		<!--服务选项window begin-->
		<div class="serviceDivWrap z666 middle">
			<div class="dShow">
				<div class="serviceDiv">
					<div class="sTitle">
						您需要我们为您做什么呢
					</div>
					<div class="sContent">
					</div>
				</div>
				<div class="c-btn">
					<i class="icono-crossCircle"></i>
				</div>
			</div>
		</div>
		<!--服务选项window end-->
		<!--遮盖层 div -->
		<div class="mask z100"></div>
		<!--同伴下单提示弹窗begin -->
		<div class="orderTip z666">
		</div>
		<!--同伴下单提示弹窗end-->
		<!--显示或者隐藏菜单按钮 begin -->
		<div class="btnShow z66">
			<div class="toggleBtn">
				<i class="icono-plus"></i>
			</div>
		</div>
		<!--显示或者隐藏菜单按钮 end -->
		<!--按钮选项列表begin -->
		<div class="btnGroup z666 btnHidden">
			<div class="btnDiv">
				<div class="btnBorder" id="btn-goodsCart">
					<div class="btn">
						<span class="middle">购物车</span>
					</div>
				</div>
			</div>
			<div class="btnDiv">
				<div class="btnBorder" id="btn-takingorders">
					<div class="btn">
						<span class="middle">点餐</span>
					</div>
				</div>
			</div>
			<div class="btnDiv">
				<div class="btnBorder" id="btn-myorder">
					<div class="btn">
						<span class="middle">进行中订单</span>
					</div>
				</div>
			</div>
			<div class="btnDiv">
				<div class="btnBorder" id="btn-historyorder">
					<div class="btn">
						<span class="middle">历史订单</span>
					</div>
				</div>
			</div>
			<div class="btnDiv">
				<div class="btnBorder" id="btn-userInfo">
					<div class="btn">
						<span class="middle">个人信息</span>
					</div>
				</div>
			</div>
		</div>
		<!--按钮选项列表end -->
		<div id="cartFixedDiv" class="fixedDiv">
			<div class="theMenu">
				<i class="cartIcon"></i>
				<span>加菜</span>
			</div>
			<div class="borTop">
				<div class="costSum">${(myOrder.totalPrices?if_exists)?string('0.00')}</div>
				<#if isEmpty==1> 
					<button id="jiezhang" class="button checkOut disable">
				<#else>
					<button id="jiezhang" class="button checkOut">
				</#if>
			    	去结账
			    </button>
			</div>
		</div>
		<!-- 选择支付方式 begin -->
		<div id="checkPayment">
			<div class="checkOutWrap">
				<!--应付金额begin -->
				<div class="totalMoneyDiv">
					<span>应付金额</span>
					<span class="totalMoney"><span style="font-size:.8rem">￥</span><span class="digit"><#if isEmpty!=1>${(myOrder.totalPrices?if_exists)?string('0.00')}</#if></span></span>
				</div>
				<!--应付金额end -->
				<!--付款方式选择begin -->
				<div class="paymentDiv">
					<div class="paytitle">选择支付方式</div>
					<#if payModel?? && payModel==21 >
						<div class="payment" paymodel="21">
							<input type="hidden" id="payModel" value="21" />
				        	<div class="payment_text weixin">
				          		<div>微信支付</div>
				          		<div class="recomment">推荐有微信支付账号的用户使用</div>
				          	</div>
				        	<div class="option nochecked"></div>
				      	</div>
				    </#if>
					<#if payModel?? && payModel==1 >
				    	<div class="payment" payModel="1">
				    		<input type="hidden" id="payModel" value="1" />
				        	<div class="payment_text alipay">
				          		<div>支付宝支付</div>
				          		<div class="recomment">推荐有支付宝账号的用户使用</div>
				          	</div>
				        	<div class="option checked"></div>
				      	</div>
				    </#if>
				    <#if userInfo.isBinding == true>
				    	<div class="payment" payModel="20">
				    		<input type="hidden" id="payModel" value="20" />
				        	<div class="payment_text vip">
				          		<div>会员卡支付</div>
				          		<div class="balance">余额：<span id="blance"></span></div>
				          	</div>
				        	<div class="option nochecked"></div>
				     	</div>
				    </#if>
				    <#if myOrder?? && myOrder.orderStatus==-1 && myOrder.payStatus==0>
				    <#else>
				    	<#if orderMode?? && orderMode==1>
					    	<div class="payment"  payModel="9">
					    		<input type="hidden" id="payModel" value="9" />
					     		<div class="payment_text cash">
					          		<span>呼叫服务员-现金支付</span>
					          	</div>
					        	<div class="option nochecked"></div>
					      	</div>
					      	<div class="payment" payModel="101">
					      		<input type="hidden" id="payModel" value="101" />
					        	<div class="payment_text card">
					          		<span>呼叫服务员-刷卡支付</span>
					          	</div>
					          	<div class="option nochecked"></div>
					    	</div>
				    	</#if>
				    </#if>
				    <!--找人代付begin -->
			    </div>
			    <div class="paymentDiv">
					<div class="rePayDiv" id="findOtherPay" style="padding:0px;">
						<div class="payment rePay" paymodel="">
				      		<input type="hidden" value="">
				      		<#if isEmpty!=1>
					          	<#if myOrder.isOtherPay?? && myOrder.isOtherPay==-1>
					          		<div class="payment_text" style="padding-top: 0.625rem;">
					          			<div>找人代付</div>
					          			<div class="balance">代付请求已发送，等待好友支付</div>
					          		</div>
					          	<#else>
					          		<div class="payment_text">
					          			<span>找人代付</span>
					          		</div>
					          	</#if>
				          	</#if>
				         	<div class="icon"></div>
				    	</div>
					</div>
		    		<!--找人代付end -->
                    <#if userInfo.isBinding != true>
                        <input type="hidden" id="vipFlag" value="0">
                        <div class="modeMore">更多支付方式</div>
                        <#else>
                        <input type="hidden" id="vipFlag" value="1">
                    </#if>
				</div>
				<!--付款方式选择end -->
			</div>
			<!--底部固定部分 begin-->
			<div class="fixedDiv">
				<!--加菜按钮begin -->
				<div class="paying">
					 确认支付￥<span class="payMoney"><#if isEmpty!=1>${(myOrder.totalPrices?if_exists)?string('0.00')}</#if></span>
				</div>
				<!--加菜按钮end -->
			</div>
		</div>
		<!-- 选择支付方式 end -->
		<!--更改手机号码div begin-->
		<div class="editTelDiv z666 middle">
			<div class="sShow">
				<div class="editInfo">
					<div class="e-title">
						绑定号码
					</div>
					<div class="tips">
						您好，为了更好的为您服务
						请告诉我们您的手机号码
					</div>
					<!--获得手机验证码begin -->
					<div class="telInfo">
						<div class="telNo">
							<span class="label">手机号</span>
							<input id="mobile" class="telInput" type="tel" placeholder="手机号即为您的会员号" maxlength="11"/>
							<input id="oldMobile" type="hidden" value="${userInfo.mobile?if_exists}" />
						</div>
						<div class="telTip"></div>
						<div class="telCode">
							<span class="label">验证码</span>
							<input id="code" class="codeInput" type="tel" placeholder="短信验证码" maxlength="6"/>
							<button id="get-code" class="getCode">获取验证码</button>
						</div>
						<div class="codeTip"></div>
					</div>
					<!--获得手机验证码end -->
					<!--确定&取消按钮begin-->
					<div class="btnContrl">
						<div class="cancel" id="user_cancel">
							取消
						</div>
						<div class="confirm" id="mySubmit">
							确定
						</div>
					</div>
					<!--确定&取消按钮end-->
				</div>
				<!--关闭按钮 begin -->
				<div class="c-btn">
					<i class="icono-crossCircle"></i>
				</div>
				<!--关闭按钮 end -->
			</div>
		</div>
		<!--更改手机号码div end-->
		
		<input type="hidden" id="shopperId" value="${shopper.id?c}" />
		<#if orderMode?? && orderMode==0>
			<input type="hidden" id="tableNo" value="" />
		   	<input type="hidden" id="tableId" value="" />
		<#else>
			<input type="hidden" id="tableNo" value="${tableInfo.name}" />
		   	<input type="hidden" id="tableId" value="${tableInfo.uid}" />
		</#if>
		<input type="hidden" id="isOpenPayWin" value="${isOpenPayWin?if_exists}" />
		
		<#if machineId??>
			 <input type="hidden" id="machineId" value="${machineId?c}" />
			 <#else>
			 <input type="hidden" id="machineId" value="" />
		</#if>
		<input type="hidden" id="buyerId" value="${buyerId}" />
		<input type="hidden" id="thirdUserId" value="${thirdUserInfo.id}">
		<input type="hidden" id="buyerNick" value="${buyerNick}" />
		<input type="hidden" id="avatarPath" value="${avatarPath}" />
		<input type="hidden" id="currentPage" value="simple-myorder"/>
		<input type="hidden" id="isEmpty" value="${isEmpty}" />
		<input type="hidden" id="isSendCreateOrderMsg" value="${isSendCreateOrderMsg?if_exists}" />
		<input type="hidden" id="orderNum" value="${orderNum?if_exists}" />
		<#if myOrder?? && myOrder.orderStatus==-1 && myOrder.payStatus==0>
			<input type="hidden" id="isShowPayWin" value="1">
			<#else>
			<input type="hidden" id="isShowPayWin" value="0">
		</#if>
		<script type="text/javascript" src="${basePath}/assets/js/jquery-1.9.1.js"></script>
		<script type="text/javascript" src="${basePath}/assets/js/fastclick.js"></script>
		<script src="https://as.alipayobjects.com/g/component/antbridge/1.1.1/antbridge.min.js"></script>
		<script type="text/javascript" src="${basePath}/assets/js/simple-base.js?v=17.03.08.1"></script>
		<script type="text/javascript" src="${basePath}/assets/js/mqttws31.js"></script>
		<script type="text/javascript" src="${basePath}/assets/js/simple-mqtt-msg.js?v=17.03.08.1"></script>
		<script type="text/javascript" src="${basePath}/assets/js/simple-service.js?v=17.03.08.1"></script>
		<script type="text/javascript" src="${basePath}/assets/js/simple-order.js?v=17.03.08.1"></script>
		<script type="text/javascript" src="${basePath}/assets/js/simple-myorder.js?v=17.03.08.1"></script>
	</body>
</html>
